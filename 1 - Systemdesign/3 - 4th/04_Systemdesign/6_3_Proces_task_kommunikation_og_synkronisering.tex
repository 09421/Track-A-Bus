\documentclass[Main.tex]{subfiles} 
\begin{document}

\subsection{Proces/task kommunikation og synkronisering}
\textbf{Kommunikation}\\
Trådene System og MsgQueue kommunikerer via et publish/subscriber relationship. Overordnet set betyder det, at klassen MsgQueue er publisher og databaseobserveren er subscriberen på indkommende beskeder fra MsgQueue.\\\\
Trådene System og Homing samt System og BrickSort kommunikerer ved, at systemet ser på givne værdier for nogen medlemsvariabler, og hvis disse er opfyldt bliver trådene eksekveret.\\\\
Trådene System og CheckForHoming bliver kørt i forbindelse med, at Homing tråden er aktiv. CheckForHoming venter på at en medlemsvariabel er blevet ændret i Homing tråden for derefter at ændre noget tekst i brugergrænsefladen. \\\\
Trådene System og ResetRobot kommunikere ved at brugeren trykker på en knap på brugergrænsefladen, mens brugeren er ved at sortere en klods, hvilket betyder at tråden BrickSort er igangsat. Tråden BrickSort vil blive stoppet og robotarmen vil vende tilbage til startpositionen. \\\\
\textbf{Synkronisering}\\
Trådene System og MsgQueue har behov for at blive synkroniseret. Indsætning af beskeder i køen kan gøres lige så ofte, som brugeren har behov for, men i tilfælde af, at der er en besked, der kræver hentning fra databasen, er der behov for synkronisering. System tråden må ikke fortsætte, så længe der er en sådan besked i køen. Derfor er der blevet gjort brug af en semafor. Denne semafor frigives når data er hentet fra databasen og lagt over i RetrievedItemsList. Når beskeden er håndteret må systemet fortsætte. Semaforen kan tilgås med to funktioner, WaitSem og ReleaseSem, fra DatabaseObserver klassen. I tilfælde af, at to beskeder, der skal hente fra databasen, bliver lagt i køen samtidig fra to forskellige tråde, er det nødvendigt at lade den ene tage semaforen, og lade den anden vente i et loop indtil semaforen er frigivet igen. Hvis der ikke tages højde for dette, og der er to tråde der venter på samme tid, er det ikke sikkert, hvilken en af dem, der bliver frigivet når Release bliver kaldt på semaforen.
\end{document}